---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// Funci√≥n para obtener los carros desde la API
async function fetchCars() {
  try {
    const response = await fetch('http://localhost:5000/api/cars');
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const cars = await response.json();
    return cars;
  } catch (error) {
    console.error('Failed to fetch cars:', error);
    return [];
  }
}

const cars = await fetchCars();
---

<html>
<head>
    <title>Tienda de Carros</title>
    <link rel="stylesheet" href="/global.css">
</head>
<body>
    <Header />
    <div class="container mx-auto px-4 py-16">
        <h1 class="text-xl font-bold text-center">Bienvenido a la Tienda de Carros</h1>
        <p class="text-center mt-4">Explora nuestra amplia gama de carros y encuentra el perfecto para ti.</p>
        <div id="car-list" class="grid grid-cols-3 gap-4">
            {cars.map((car) => (
                <div class="border p-4 mb-4">
                    <h2 class="text-lg font-bold">{car.brand} {car.model} ({car.year})</h2>
                    <p>Propietario: {car.owner}</p>
                    <p>Precio: ${car.price}</p>
                    <img src={car.Image} alt="Imagen del Carro" />
                </div>
            ))}
        </div>
    </div>
    <Footer />
</body>
</html>
